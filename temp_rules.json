{
    "branch_protection_rules": {
        "main": {
            "required_pull_request_reviews": {
                "dismiss_stale_reviews": true,
                "require_code_owner_reviews": true,
                "required_approving_review_count": 1,
                "require_last_push_approval": true
            },
            "required_status_checks": {
                "strict": true,
                "contexts": [
                    "build",
                    "lint",
                    "typecheck"
                ]
            },
            "enforce_admins": false,
            "required_linear_history": true,
            "allow_force_pushes": false,
            "allow_deletions": false,
            "required_conversation_resolution": true,
            "lock_branch": false,
            "restrictions": {
                "users": [
                    "SheetMetalConnect"
                ],
                "teams": []
            }
        }
    },
    "repository_rules": {
        "rulesets": [
            {
                "name": "Protect Critical Files",
                "target": "branch",
                "enforcement": "active",
                "conditions": {
                    "ref_name": {
                        "include": [
                            "refs/heads/main"
                        ],
                        "exclude": []
                    }
                },
                "rules": [
                    {
                        "type": "file_path_restriction",
                        "parameters": {
                            "restricted_file_paths": [
                                "supabase/migrations/**",
                                "package.json",
                                "package-lock.json",
                                ".env.example",
                                "LICENSE",
                                "docker-compose.prod.yml",
                                "wrangler.toml"
                            ]
                        }
                    }
                ]
            },
            {
                "name": "Require PR for All Changes",
                "target": "branch",
                "enforcement": "active",
                "conditions": {
                    "ref_name": {
                        "include": [
                            "refs/heads/main"
                        ],
                        "exclude": []
                    }
                },
                "rules": [
                    {
                        "type": "pull_request",
                        "parameters": {
                            "required_approving_review_count": 1,
                            "dismiss_stale_reviews_on_push": true,
                            "require_code_owner_review": true,
                            "require_last_push_approval": false
                        }
                    },
                    {
                        "type": "required_status_checks",
                        "parameters": {
                            "required_status_checks": [
                                {
                                    "context": "build",
                                    "integration_id": null
                                },
                                {
                                    "context": "lint",
                                    "integration_id": null
                                },
                                {
                                    "context": "typecheck",
                                    "integration_id": null
                                }
                            ],
                            "strict_required_status_checks_policy": true
                        }
                    }
                ]
            }
        ]
    },
    "codeowners": {
        "file_content": "# Default owners for everything\n* @SheetMetalConnect\n\n# Database migrations require extra scrutiny\nsupabase/migrations/** @SheetMetalConnect\n\n# API functions\nsupabase/functions/** @SheetMetalConnect\n\n# Deployment configs\ndocker-compose.prod.yml @SheetMetalConnect\nwrangler.toml @SheetMetalConnect\nvercel.json @SheetMetalConnect\nCaddyfile @SheetMetalConnect\nnginx.conf @SheetMetalConnect\n\n# Package management\npackage.json @SheetMetalConnect\npackage-lock.json @SheetMetalConnect\n\n# Core config\ntsconfig*.json @SheetMetalConnect\nvite.config.ts @SheetMetalConnect"
    },
    "github_actions_workflow": {
        "file": ".github/workflows/ci.yml",
        "content": "name: CI\n\non:\n  pull_request:\n    branches: [main]\n  push:\n    branches: [main]\n\njobs:\n  lint:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-node@v4\n        with:\n          node-version: '20'\n          cache: 'npm'\n      - run: npm ci\n      - run: npm run lint\n\n  typecheck:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-node@v4\n        with:\n          node-version: '20'\n          cache: 'npm'\n      - run: npm ci\n      - run: npx tsc --noEmit\n\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-node@v4\n        with:\n          node-version: '20'\n          cache: 'npm'\n      - run: npm ci\n      - run: npm run build"
    }
}